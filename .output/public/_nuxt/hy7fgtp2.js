import{_ as C,a as j,b as z}from"./b8cufphi.js";import{_ as F}from"./b72e89xr.js";import{_ as B}from"./cvxw6bcr.js";import{e as O,f as T,l as N,m as A,c as G,b as o,h as l,a as d,w as r,F as M,p as b,s as m,o as S,d as f}from"./c6lvz2om.js";import{m as $,a as v,d as g}from"./mu41mkrl.js";import"./k2lpch8j.js";import"./ou69qqfo.js";import"./mtqglvzn.js";const E={class:"space-y-4 flex flex-col p-4 my-4 dark:bg-neutral-800"},H={class:"flex justify-end gap-2 my-2"},I=["src"],X=O({__name:"settings",setup(P){const _=$(),c=T("userinfo"),a=N({password:"",username:"",nickname:"",slogan:"",avatarUrl:"",coverUrl:"",css:"",js:""}),U=async()=>{_.value.userinfo={},await b("/")},y=async()=>{const s=await v("/user/profile");s&&(Object.assign(a,s),c.value=s)},V=async()=>{await v("/user/saveProfile",a),m.success("保存成功"),await y()},x=async s=>{for(let t=0;t<s.length;t++)if(s[t].type.indexOf("image")<0){m.error("只能上传图片");return}const e=await g(s);m.success("上传成功"),e&&(a.avatarUrl=e[0])},w=async s=>{for(let t=0;t<s.length;t++)if(s[t].type.indexOf("image")<0){m.error("只能上传图片");return}const e=await g(s);m.success("上传成功"),e&&(a.coverUrl=e[0])};return A(async()=>{Object.assign(a,c.value)}),(s,e)=>{const t=C,p=j,u=z,k=F,i=B;return S(),G(M,null,[o(t,{user:l(c)},null,8,["user"]),d("div",E,[d("div",H,[o(p,{onClick:e[0]||(e[0]=n=>("navigateTo"in s?s.navigateTo:l(b))("/")),icon:"i-carbon-arrow-left",size:"xs",color:"gray",variant:"solid"},{default:r(()=>e[7]||(e[7]=[f("返回")])),_:1}),o(p,{onClick:U,icon:"i-carbon-logout",size:"xs",color:"white",variant:"solid"},{default:r(()=>e[8]||(e[8]=[f("登出")])),_:1})]),o(i,{label:"头像",name:"avatarUrl",ui:{label:{base:"font-bold"}}},{default:r(()=>[o(u,{type:"file",size:"sm",icon:"i-heroicons-folder",onChange:x}),e[9]||(e[9]=d("div",{class:"text-gray-500 text-sm my-2"},"或者输入在线地址",-1)),o(u,{modelValue:l(a).avatarUrl,"onUpdate:modelValue":e[1]||(e[1]=n=>l(a).avatarUrl=n),class:"mb-2"},null,8,["modelValue"]),o(k,{src:l(a).avatarUrl,size:"lg"},null,8,["src"])]),_:1}),o(i,{label:"顶部图片",name:"coverUrl",ui:{label:{base:"font-bold"}}},{default:r(()=>[o(u,{type:"file",size:"sm",icon:"i-heroicons-folder",onChange:w}),e[10]||(e[10]=d("div",{class:"text-gray-500 text-sm my-2"},"或者输入在线地址",-1)),o(u,{modelValue:l(a).coverUrl,"onUpdate:modelValue":e[2]||(e[2]=n=>l(a).coverUrl=n),class:"mb-2"},null,8,["modelValue"]),d("img",{src:l(a).coverUrl,class:"w-full rounded object-cover",alt:""},null,8,I)]),_:1}),o(i,{label:"登录名",name:"username",ui:{label:{base:"font-bold"}}},{default:r(()=>[o(u,{modelValue:l(a).username,"onUpdate:modelValue":e[3]||(e[3]=n=>l(a).username=n),disabled:""},null,8,["modelValue"])]),_:1}),o(i,{label:"昵称",name:"nickname",ui:{label:{base:"font-bold"}}},{default:r(()=>[o(u,{modelValue:l(a).nickname,"onUpdate:modelValue":e[4]||(e[4]=n=>l(a).nickname=n)},null,8,["modelValue"])]),_:1}),o(i,{label:"心情状态",name:"slogan",ui:{label:{base:"font-bold"}}},{default:r(()=>[o(u,{modelValue:l(a).slogan,"onUpdate:modelValue":e[5]||(e[5]=n=>l(a).slogan=n)},null,8,["modelValue"])]),_:1}),o(i,{label:"密码",name:"slogan",ui:{label:{base:"font-bold"}}},{default:r(()=>[o(u,{modelValue:l(a).password,"onUpdate:modelValue":e[6]||(e[6]=n=>l(a).password=n),type:"password",placeholder:"留空则不修改密码"},null,8,["modelValue"])]),_:1}),o(p,{class:"justify-center",onClick:V},{default:r(()=>e[11]||(e[11]=[f("保存")])),_:1})])],64)}}});export{X as default};
